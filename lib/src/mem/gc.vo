
use volt:mem

// shared gc : ?GC = null
// shared gc_age : char = 0
// shared gc_busy : uint = 0

struct GC {
    stacks : ptr
    stack_count : uint (0)

    static fn start() {
        let gc = GC {
            stacks: mem:alloc(10000 @as uint)
        }
    }

    fn add_stack(s: Stack) {
        let adr = this.stacks
        adr += sizeof(ptr) * this.stack_count
        @ptrv(adr, ptr) = s @as ptr
        this.stack_count++
    }
}
